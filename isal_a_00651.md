

Flow-Lenia: Towards open-ended evolution in cellular automata through mass
conservation and parameter localization
## Erwan Plantec
## 1
## , Gautier Hamon
## 1
## , Mayalen Etcheverry
## 1,2
, Pierre-Yves Oudeyer
## 1
## ,
## Cl
## ́
ement Moulin-Frier
## 1
and Bert Wang-Chak Chan
## 1,3
## 1
FLOWERS Team, Inria, Bordeaux, France
## 2
## Poietis, Pessac, France
## 3
Brain Team, Google research, Tokyo, Japan
erpl@itu.dk
## Abstract
The  design  of  complex  self-organising  systems  producing
life-like phenomena, such as the open-ended evolution of vir-
tual creatures, is one of the main goals of artificial life.  Le-
nia,  a  family  of  cellular  automata  (CA)  generalizing  Con-
way’s  Game  of  Life  to  continuous  space,  time  and  states,
has  attracted  a  lot  of  attention  because  of  the  wide  diver-
sity of self-organizing patterns it can generate. Among those,
some spatially localized patterns (SLPs) resemble life-like ar-
tificial creatures and display complex behaviors.   However,
those creatures are found in only a small subspace of the Le-
nia  parameter  space  and  are  not  trivial  to  discover,  neces-
sitating  advanced  search  algorithms.   Furthermore,  each  of
these creatures exist only in worlds governed by specific up-
date rules and thus cannot interact in the same one.  This pa-
per proposes as mass-conservative extension of Lenia, called
Flow Lenia, that solve both of these issues.  We present ex-
periments demonstrating its effectiveness in generating SLPs
with complex behaviors and show that the update rule param-
eters can be optimized to generate SLPs showing behaviors
of  interest.   Finally,  we  show  that  Flow  Lenia  enables  the
integration of the parameters of the CA update rules within
the CA dynamics,  making them dynamic and localized,  al-
lowing  for  multi-species  simulations,  with  locally  coherent
update rules that define properties of the emerging creatures,
and  that  can  be  mixed  with  neighbouring  rules.   We  argue
that  this  paves  the  way  for  the  intrinsic  evolution  of  self-
organized artificial life forms within continuous CAs. A note-
book with Flow Lenia implementation and demo are available
athttps://tinyurl.com/mr2ncy3h.
## Introduction
Complex self-organizing systems have been central to Ar-
tificial  Life  (ALife)  towards  the  search  of  emergent  life-
reminiscent phenomena. Among those systems are continu-
ous cellular automata (CA) like SmoothLife (Rafler, 2011)
or Lenia (Chan, 2019). Lenia is a family of CA generalizing
Conway’s  Game  of  Life  (GoL)  to  continuous  space,  time
and  states  (Chan,  2019,  2020).   Each  instance  of  Lenia  is
given by a specific configuration of parameters defining its
update rule and an initial configuration which map to a spe-
cific pattern and behavior in a deterministic way.  Lenia is a
generalization of GoL as the latter corresponds to a specific
parameter set in Lenia.
## (a)(b)(c)
## (d)(e)(f)
## (g)(h)(i)
## (j)
Figure  1:   Flow  Lenia  creatures.    (a-c)  Samples  of  crea-
tures  found  through  random  search  in  Flow  Lenia  param-
eter  space.    (d-f)  and  (g-i)  Timelapses  of  patterns  found
through  random  search.Colors  in  (g-i)  code  for  dif-
ferent  channels.(j)  Effect  of  changing  temperature  in
Flow  Lenia,  temperature  is  linearly  increasing  from  left
to  right.Videos  are  available  athttps://sites.
google.com/view/flowlenia/videos.
Previous  studies  with  Lenia  have  shown  the  emergence
of  autopo
## ̈
ıetic  (i.e  self-produced)  spatially  localized  pat-
terns (SLPs), also called “creatures”, often resembling mi-
croscopic life-forms and displaying various behaviors like
Downloaded from http://direct.mit.edu/isal/proceedings-pdf/isal2023/35/131/2354989/isal_a_00651.pdf by guest on 24 January 2026

motility  or  self-replication.   Such  observations  have  made
Lenia  a  particularly  interesting  system  for  studying  the
emergence of life-like phenomenon and even sensori-motor
capabilities (Hamon et al., 2022).  Importantly, these artifi-
cial creatures bear a deep similarity to their biological coun-
terparts as enacted agents endowed with constitutive auton-
omy (i.e creatures are self-producing) as described by en-
active theories of cognition (see Froese and Ziemke (2009)
for a more complete discussion on enactive artificial intelli-
gence).
However, those patterns are quite difficult to find, necessi-
tating complex fine-tuned search algorithms in order to find
update rule parameters allowing the emergence of interest-
ing patterns (e.g spatially localized patterns).  For instance,
complex patterns have been found in (Hamon et al., 2022)
using intrinsically motivated goal exploration processes and
gradient descent.
Another  important  challenge  in  ALife  and  artificial  intel-
ligence  is  about  the  design  of  systems  displaying  open-
ended intrinsic evolution (i.e unbounded growth of complex-
ity through intrinsic evolutionary processes) (Stanley, 2019).
Such a process is calledintrinsicsince no final objective (i.e
fixed fitness function) is set by the experimenter, the fitness
landscape is intrinsic to the system and depends only on its
current state, as in natural evolution where there is no final
goal (Lehman and Stanley, 2011).   Systems like EvoLoop
(Sayama, 1999) or an extension of it, SexyLoop (Oros and
Nehaniv, 2007),  allow for evolutionary processes to occur
in CA. However,  such systems rely on hand-defined rules
and particular structures ultimately limiting the kind of pat-
terns that can emerge in the system. On the other hand, even
though  Lenia  creatures  display  greater  diversity,  different
creatures (governed by different update rules) cannot exist
in the same world (i.e the same simulation) and thus cannot
interact.   Obtaining such an evolutionary process in a CA
could be achieved by embedding information in the system
locally modifying the update rule and so the properties of
emerging creatures,  like a genome,  enabling multi-species
simulations. Such simulations might set the stage for evolu-
tion to occur in populations of patterns each with their own
update rule.  However, achieving it in CA like Lenia is still
an open-problem.
We believe that adding mass conservation is a key ingredient
to address the aforementioned challenges. Such a constraint
could (i) constrain emerging creatures to spatially localized
ones, (ii) allow for the design of multi-species simulations
and (iii) provide an important evolutionary pressure (Hick-
inbotham and Stepney, 2015).   We propose in this work a
mass-conservative extension to Lenia calledFlow Leniaand
demonstrate that such conservation laws effectively facili-
tate  the  search  fort  artificial  creatures  by  constraining  (al-
most all) emerging patterns to spatially localized ones.  We
also show that the update rule parameters can easily be opti-
mized using vanilla evolutionary strategies (Salimans et al.,
2017) with respect to some fitness functions to obtain pat-
terns with specific properties such as directed motion or an-
gular  motion.   Importantly,  we  show  that  the  Flow  Lenia
formulation enables the integration of the parameters of the
CA update rules within the CA dynamics, making them dy-
namic and localized, allowing for multi-species simulations,
with locally coherent update rules that define properties of
the emerging creatures.  Finally, we propose a resource col-
lection mechanism which could act as a selective pressure in
such multi-species simulations.
## Model
LetLbe the support of a CA, which is the two-dimensional
gridZ
## 2
in the rest of this work.  LetA
t
## :L →S
## C
be CA’s
activations at timet,  withA
t
i
(x)the activation in location
x∈ L, channeliand timet.Cis the number of channels
of the system ansSis the state space (the set of states a cell
can take in each channel).
## Lenia
The state spaceSin Lenia is the unit range[0,1].  An in-
stance of Lenia is defined by a tuple< K,G,A
## 0
## >where
Kis a set of convolution kernels whereK
i
## :L →[0,1]
satisfies
## R
## L
## K
i
= 1andGis a set of growth functions with
## G
i
: [0,1]→[−1,1].  Each pair(K
i
## ,G
i
)is associated to a
source channelc
i
## 0
it senses and a target channelc
i
## 1
it updates.
Connectivity can be represented through a square adjacency
matrixM
## C,C
## =
## 
## 
## 
m
## 11
## ···m
## 1C
## .
## .
## .
## .
## .
## .
## .
## .
## .
m
## C1
## ···m
## CC
## 
## 
## 
wherem
ij
∈Nis
the number of kernels sensing channeliand updating chan-
nelj.A
## 0
is the initial state of the system.   As in Hamon
et al. (2022), kernels are radially symmetrical and defined as
a sum of concentric Gaussian bumps :
## K
i
## (x) =
k
## X
j=1
b
i,j
exp

## −
## (
x
r
i
## R
## −a
i,j
## )
## 2
## 2w
## 2
i,j
## !
## (1)
## Wherea
i
## ,b
i
## ,w
i
andr
i
are parameters defining kerneli.k
is a parameter defining the number of rings per kernel (set to
3 here) andRis a parameter common to all kernels defining
the maximum neighborhood radius. Each kernel is then de-
fined by3×k+ 1parameters. Growth functions are defined
as Gaussian function scaled in the range[−1,1]:
## G
i
## (x) = 2exp
## 
## −
## (μ
i
## −x)
## 2
## 2σ
## 2
i
## 
## −1(2)
## Whereμ
i
andσ
i
are parameters of growth functioniso each
growth function is defined by2parameters. A step in Lenia
is defined by the following steps (see figure 2 (top)) :
-  Compute the growth at timetgiven the actual stateA
t
## :
## U
t
j
## =
## |K|
## X
i=1
h
i
## ·G
i
## (K
i
## ∗A
t
c
i
## 0
## )·[c
i
## 1
## =j](3)
Downloaded from http://direct.mit.edu/isal/proceedings-pdf/isal2023/35/131/2354989/isal_a_00651.pdf by guest on 24 January 2026

Figure 2: Top left : Lenia update rule. The growthU
t
is computed with kernelsKand growth functionsG(equation 3) defined
by a specific parameter configuration sampled in Lenia’s parameter space.   A small portion of the growth is then added to
activationsA
t
to give the next stateA
t+dt
(equation 4).  Bottom left :  Flow Lenia update rule.  Affinity mapU
t
is computed
as in Lenia.  The flowF
t
is given by combining the affinity map and concentration (i.e activations) gradients (equation 5).
Finally, the next state is obtained by “moving” matter in the CA space according to the flowF
t
using reintegration tracking
(RT) (equations 6 and 7). Right : Patterns generated from randomly sampled parameters sets (no cherry picking) in Lenia (left)
and Flow Lenia (right). Parameters used for both systems are the same (i.e each row corresponds to one parameters set).
Whereh∈R
## |K|
is a vector weighting the importance of
each  pair(K
i
## ,G
i
## )and[c
i
## 1
=j]is  the  Iverson  bracket
which equals 1 ifc
i
## 1
=jand 0 otherwise (i.e equals 1 if
the ith pair updates channelj).
-  Add a small portion of the growthU
t
to the actual state
## A
t
to get the state at the next time step and clip results
back to the unit range :
## A
t+dt
i
## = [A
t
i
+dtU
t
i
## ]
## 1
## 0
## (4)
## Flow Lenia
Flow Lenia is a mass-conservative extension to Lenia.  By
mass-conservative,  we  mean  that  the  sum  of  activations
across all cells and for each channel is constant over time
## :
## X
x∈L
## A
t
c
## =
## X
x∈L
## A
t+dt
c
,∀t,∀c∈{1,...,C}
We propose for this system to interpret activations as con-
centrations of “matter” in all cells and to refer to the term
## U
t
, previously called the growth in Lenia, as an affinity map.
The idea is that the matter will move towards higher affinity
regions by following the local gradient of the affinity mapU,
## ∇U:L→R
## 2
. To do so, we define a flowF:L→(R
## 2
## )
## C
## ,
which can be interpreted as the instantaneous speed of mat-
ter, as:
## (
## F
t
i
## = (1−α
t
## )∇U
t
i
## −α
t
## ∇A
t
## Σ
α
t
(p) = [(A
t
## Σ
## (p)/θ
## A
## )
n
## ]
## 1
## 0
## (5)
WithA
t
## Σ
## (p) =
## P
## C
i=1
## A
t
i
(p)the total mass in each location
p. Here∇U
t
i
is the affinity gradient for channeli. The neg-
ative  concentration  gradient−∇A
t
## Σ
is  a  diffusion  term  to
avoid concentrating all the matter in very small regions akin
to the clipping in Lenia which upper bounds concentrations.
In practice, gradients are estimated through Sobel filtering.
Mapα:L→[0,1]is used to weight the importance of each
term such that−∇A
t
## Σ
dominates when the total mass at a
given location is close to a critical massθ
## A
## ∈R
## >0
## .  Intu-
itively, the result is that matter is mainly driven by concen-
tration gradients in high concentrations regions and is more
free to move along the affinity gradient in less concentrated
areas. We typically usen >1such that the affinity gradient
dominates on a larger range of masses.
Then, we can move matter in space according to flowFgiv-
ing us the state at the next time step.  To do so we use the
reintegration  tracking  method  proposed  in  (Moroz,  2020).
Reintegration tracking is a semi-Lagrangian grid based al-
gorithm  thought  as  a  reformulation  of  particle  tracking  in
screen space (i.e grid space) aimed at not losing information
(i.e particles) which happens when two particles end up in
Downloaded from http://direct.mit.edu/isal/proceedings-pdf/isal2023/35/131/2354989/isal_a_00651.pdf by guest on 24 January 2026

the same cell.  The basic principle is to work with distribu-
tion of particles (i.e infinite number of particles) and con-
serve the total mass by adding up masses going on a same
cell.  Overall, reintegration tracking can be seen as a grid-
based approximation to particle systems with infinite num-
ber of particles having the property to conserve total mass.
Thus,  Flow  lenia  can  be  seen  as  a  new  kind  of  model  at
the  frontier  between  continuous  CA  and  particle  systems.
A  particle  based  model  directly  inspired  by  the  Flow  Le-
nia formulation has been recently proposed in Mordvintsev
et al. (2022). Figure 3 illustrates how reintegration tracking
is used in our case. The resulting update rule is the following
## :
## A
t+dt
i
## (p) =
## X
p
## ′
## ∈L
## A
t
i
## (p
## ′
## )I
i
## (p
## ′
## ,p)(6)
WhereI
i
## (p
## ′
,p)is the proportion of incoming matter in chan-
neligoing from cellp
## ′
∈Lto cellp∈L:
## I
i
## (p
## ′
## ,p) =
## Z
## Ω(p)
## D(p
## ′′
i
## ,s)(7)
## Withp
## ′′
i
## =p
## ′
+dt·F
t
i
## (p
## ′
)the target location of the flow
fromp
## ′
.Ω(p)is  the  domain  of  cell  at  locationp,  which
is a square of side1.D(m,s)is a distribution defined on
Lwith meanmand variancessatisfying
## R
## L
## D(m,s) = 1,
which is in practice a uniform square distribution with side
length2scentered atm.  This distribution emulates a flow
of particles from source areaΩ(p
## ′
)to target areaD(p
## ′′
## ,s),
where the distributionDemulates Brownian motion at the
low level.sis an hyperparameter of the system which can
be seen as form of temperature.  The reintegration tracking
method is depicted in Fig.  3.  Since the distributionDinte-
grates to 1, it is clear that a cell cannot send out more mass
than it contains nor less and so the system conserves its to-
tal mass.  Mass conservation also implies that cells’ states
are no longer bound to the unit range but can be any posi-
tive real valued number (S≡R
## C
## ≥0
).  This model has been
implemented in JAX (Bradbury et al., 2018) allowing fast
simulation on GPU (255μs±3.11μsper step on Tesla T4
GPU with 1 channel, 10 kernels and128×128world size).
## Results
Random search
By performing random and manual search of the Flow Le-
nia parameter and hyperparameter space described in table 1
we have been able to discover SLPs with already interesting
and complex behaviors.  Such patterns are shown in figure
1 and described hereafter.  Initial patternsA
## 0
are set with a
40×40patch with matter drawn from uniform distribution
in the center of the grid and no matter everywhere else.
Most of the patterns generated in Flow Lenia are SLPs (see
figure 2) with rare exceptions found by manually setting pa-
rameters to specific configurations leading to scattered mat-
ter.   Using multiple kernels led to the emergence of SLPs
Figure  3:   Calculation  of  incoming  matter  to  cellp∈ L
through  reintegration  tracking  (Moroz,  2020).   Mass  con-
tained in cell at locationp
## ′
∈ Lis moved to a square distri-
butionDcentered onp
## ′′
## =p
## ′
+dt·F
t
## (p
## ′
). The proportion
of mass fromp
## ′
arriving inpis then given by the integral of
Don the cell domain ofp,Ω(p), denoted asI(p
## ′
## ,p).
NeighborhoodGrowth functions
## R∈[2,25]μ∈[0.05,0.5]*
r∈[0.2,1]*σ∈[0.001,0.2]*
KernelsFlow
h∈[0,1]*s0.65
a∈[0,1]
## 3
## *n2
b∈[0,1]
## 3
## *dt0.2
w∈[0.01,0.5]
## 3
## *
Table 1:  Flow Lenia explored parameter space.  Parameters
marked  with  a  *  must  be  sampled  for  each  kernel-growth
function pair.
with  more  complex  shapes  and  behaviors.   While  part  of
emerging patterns tend to be static ones, dynamic patterns
are  quite  common  in  Flow  Lenia.   For  instance  gyrating
SLPs  (a)  or  snake  like  patterns  (b)  with  complex  motion
emerging  from  attraction/repulsion  dynamics  can  be  fre-
quently  observed.   Dividing  and  merging  dots  (c)  resem-
bling  reaction-diffusion  patterns  are  also  a  common  pat-
tern.   Timelapse  (d-f)  shows  a  creature  with  complex  and
unpredictable dynamics emerging from the interactions of
its membrane, multiple organoids-like structures and a cen-
tral nuclei ultimately leading to a phase transition happening
in (e). Timelapse (g-e) shows a 2-channels creature display-
ing complex division patterns and interesting modular crea-
tures whose characteristics change depending on their total
mass while being of the same “kind” (i) (see 5 creatures on
the leftmost part of (i)).  Note that multi-channel creatures
often show more complex dynamics and patterns with very
modular shapes where each channel seems to occupy a dif-
Downloaded from http://direct.mit.edu/isal/proceedings-pdf/isal2023/35/131/2354989/isal_a_00651.pdf by guest on 24 January 2026

ferent role.  (j) shows the effect of changing the size of the
reintegration tracking distributions(see equation 7 and fig-
ure 3), parameter we call temperature.  Here temperature is
linearly increasing from left to right showing very different
phases  of  the  systems.   More  interestingly,  patterns  at  the
frontier between the Turing-like phase (center) and the equi-
librium phase (right) are much more dynamic and display
unpredictable dynamics suggesting a critical regime.
Optimizing Flow Lenia creatures
Figure  4:   Results  of  evolutionary  optimization.   C  is  the
number of channels of the system andkis the number of
kernels and growth functions.  When performing the exact
same optimization for directed motion in the original Lenia
system (yellow curve), not only optimization is unstable but
it only discovers exploding patterns.
In this section, we show that Flow Lenia update rule pa-
rameters  can  also  be  easily  optimized  so  to  generate  pat-
terns with specific behaviors.  This is a difficult task in Le-
nia  as  it  would  require  constantly  monitoring  the  existen-
tial  status  and  the  spatially-localizedness  of  evolved  crea-
tures.   Thus  training  creatures  in  Lenia  requires  to  define
characterizations of creatures accounting for such properties
which is a far from trivial problem.  Moreover, even if one
can come up with proxies to find spatially localized patterns,
the optimization process remains difficult necessitating ad-
vanced optimization methods like curriculum learning (Ha-
mon  et  al.,  2022).   In  Flow  Lenia,  the  spatial  localization
constraint is intrinsic to the system thus removing the neces-
sity to account for it when searching for creatures.   Using
evolutionary strategies (Salimans et al., 2017) to optimize
## (a)(b)
## (c)(d)
Figure  5:   Creatures  found  through  optimization.   (a)  Di-
rected  motion  with  2  channels  and  20  kernels.    (b)  An-
gular  motion  with  2  channels  and  20  kernels.(c)  Mo-
tion  through  obstacles  with  2  channels  and  25  kernels.
(d)  Chemotaxis  with  2  channels  and  25  kernels.   Videos
ara availabe athttps://sites.google.com/view/
flowlenia/videos.
the update rule parameters and the initial configuration (A
## 0
## )
with respect to user-defined fitness functions, we have been
able to successfully find good solutions for 4 different tasks
:  directed motion, angular motion, navigation through ob-
stacles and chemotaxis.
We  used  evosax  (Lange,  2022)  implementation  of  the
OpenES strategy with population size of16and adam opti-
mizer (Kingma and Ba, 2017) with0.01as learning rate. We
optimized the Flow Lenia update rule with different num-
ber  of  kernels  and  either  1  or  2  channels.   For  compari-
son, we also trained original Lenia on the directed motion
task  following  the  same  optimization  procedure.   The  ini-
tial pattern is composed,  as in random search,  of a square
patch with non-zero activations placed at the center of the
world  and  zeros  everywhere  else.    Results  are  shown  in
figure  4  and  code  used  to  run  experiments  is  available  at
https://tinyurl.com/mtt5ur3u.
Directed motionIn order to train creatures displaying di-
rected motion, i.e straight line motion, we used the distance
travelled by the creature as the fitness function. The distance
is calculated by computing the center of mass of the pattern
at step 0 and final step 400. Formally, the fitness function is
defined as :
f(θ) =dist(φ(A
## 0
),φ(A
## 400
## ))
Downloaded from http://direct.mit.edu/isal/proceedings-pdf/isal2023/35/131/2354989/isal_a_00651.pdf by guest on 24 January 2026

WhereA≡{A
## 0
## ,...,A
## T
}is the pattern obtained by mak-
ing a rollout with parametersθforTtimesteps (here 500).
φ(A
t
## )∈[−0.5,0.5]
## 2
is the center of mass of stateA
t
and
distis the euclidean distance function.   We optimized the
system with either 1 or 2 channels and 10 or 20 kernels. We
usedM=
## 
## 5    5
## 5    5
## 
as the adjacency matrix with 2 chan-
nels and 20 kernels andM=
## 
## 3    2
## 2    3
## 
with 10 kernels.
Results (see fig 4) show that good solutions can be found
in  the  2  channels  condition  but  not  in  the  single  channel
case.  However, when running the algorithm for longer (e.g
5000 generations), we have been able to found single chan-
nel creatures with similar fitness than their 2 channels coun-
terpart.  Increasing the number of kernels led to faster dis-
covery of good solutions.  The best performing creature is
shown  in  figure  5(a).   This  creature  moves  because  of  at-
traction/repulsion dynamics between the 2 channels which
might explain why directed motion is much easier to attain
with multi-channels creatures.  On the other hand,  the op-
timization of the original Lenia model is much less stable
and discovered patterns are less successful than their mass-
conservative counterparts. Moreover, every Lenia optimized
patterns are exploding ones.
Angular motionIn this task, we want emerging creatures
to display more complex forms of motion.  More precisely,
we want creatures to be able to move and make turns.  As
with directed motion, we use the center of mass of the crea-
ture through time to compute its trajectory. The fitness func-
tion is the following :
f(θ) =dist(φ(A
## 0
),φ(A
## 200
## ))
+dist(φ(A
## 200
),φ(A
## 400
## ))
+∠[φ(A
## 200
)−φ(A
## 0
)] [φ(A
## 400
)−φ(A
## 200
## )]
Where∠abis the angle between vectorsaandb. The first
two terms are the distance travelled from step 0 to step 200
and from step 200 to step 400. The last term is the angle be-
tween these two trajectories which is maximal when they are
opposite.  In order to avoid large angles to come from very
small movements, the angle is set to 0 when distance trav-
eled either before or after step 200 is below a given thresh-
old.  The optimal behavior for this fitness function is then
to move fast in one direction,  make a 180° turn,  and then
move fast in the opposite direction. We used 2 channels, 20
kernels and the same connectivity matrix as for directed mo-
tion.
Result are shown in figure 4.  The best performing creature,
shown in figure 5 (b), displays very complex internal dynam-
ics leading it to periodically make 180° turns while moving
in straight line the rest of the time. These dynamics seem to
be generated by attraction repulsion dynamics like the ones
observed in directed motion but here in a more intricate mor-
phology.
Navigation through obstaclesIn this task, we want to see
if creatures can navigate through obstacles as done in Ha-
mon et al. (2022).  To do so, we added walls which are im-
plemented  by  adding  a  strong  flow  going  from  the  center
of walls outwards, thus strongly repelling the creature and
acting  as  a  solid  obstacle.   At  each  evaluation  of  the  op-
timization process, we randomly sample points on a circle
surrounding the creatures’ initial positions to be walls po-
sitions thus making a “forest” of walls around the creature.
We then optimize the creature with the same fitness function
as in thedirected motiontask so creatures have to go as far as
possible and so through the forest. We made the experiment
with  2  channels  creatures,  walls  are  defined  in  a  separate
third channel. We used 25 kernels andM=
## 
## 
## 5    5    0
## 5    5    0
## 5    0    0
## 
## 
as the connectivity matrix so creatures are able to sense the
walls channel (3rd channel).
We  have  been  able  to  successfully  train  creatures  able  to
move and stay robust when making contact with walls such
as the one shown in figure 5 (c) which is able to resist de-
formation and find a way out the “forest”.  In comparison,
solving a similar task in Lenia required complex optimiza-
tion methods based on curriculum learning, diversity search
and gradient descent over a differentiable CA (Hamon et al.,
2022).    However,  such  a  comparison  is  difficult  because
Flow Lenia creatures are inherently more robust due to con-
servation  of  mass,  whereas  Lenia  creatures  can  disappear
because of perturbations.
ChemotaxisAnother  important  feature  of  natural  life-
forms is the ability to sense their environment in order to find
food or avoid dangers through chemotaxis.  In this task, we
want creatures to be able to sense a “chemical” gradient and
climb it towards its maximum. To do so, we added a separate
channelΓ :L→R
## ≥0
whose activations are defined follow-
ing a Gaussian function around a point randomly sampled
on a circle surrounding the center of the CA for each eval-
uation of the optimization process ensuring creatures learn
to follow gradient and not a fixed direction while keeping
the distance to cover constant. We also added 5 kernels and
growth functions fromΓtoA, which are also optimized, so
the creature is able to sense the chemical.  The fitness of an
individual is then computed with the following function :
f(θ) =
## P
x∈L
## A
## 500
## Σ
(x)×Γ(x)
## P
x∈L
## A
## 500
## Σ
## (x)
Since mass is conserved, the optimal behavior for a crea-
ture is to concentrate as much of its mass in the cells where
Γis maximal.
We  have  been  able  to  find  good  solutions  to  this  task  as
Downloaded from http://direct.mit.edu/isal/proceedings-pdf/isal2023/35/131/2354989/isal_a_00651.pdf by guest on 24 January 2026

shown in figure 4.  Best solutions such as the one shown in
figure 5 (d) are perfectly able to climb the gradient towards
its maximum.
Flow Lenia : Towards intrinsic evolution
## (a)
## (b)(c)
## (d)(e)
## (f)
Figure  6:    Multi-species  simulations.(a)  Sample  of  a
multi-species  simulation  where  color  code  for  parame-
ters.(b-e)  Timelapse  of  larger  scale  multi-species  sim-
ulation.World  is  a1024×1024grid  initialized  with
144creatures with distinct parameters represented by col-
ors.    We  simulate  200k  timesteps  and  use  softmax  sam-
pling as the mixing rule and random mutations every500
steps.  (f) Timelapse of simulation with parameter embed-
ding and food (in blue) showing division events (highlighted
with  boxes).   Videos  are  available  athttps://sites.
google.com/view/flowlenia/videos.
As said in the introduction, Flow Lenia allows to embed
the update rule parameters inside the CA. Intuitively, we can
“attach” a vector of parameters to the matter locally modi-
fying how it behaves (i.e locally modifying how the affinity
map  is  computed),  and  let  it  flow  with  it.   Formally,  this
comes to defining a parameter mapP:L →ΘwhereΘ
is a given parameter set.  This map can be used to locally
modify  the  update  rule.   For  instance,  we  can  embed  the
h∈R
## |K|·|K|
matrix weighting the importance of each ker-
nel in the affinity map computation (see equation 3), giving
## :
## U
t
j
## (p) =
## X
i,k
## P
t
k
(p)·G
k
## (K
k
## ∗A
t
i
## )(p)(8)
Then parameters can be moved along with matter. A ques-
tion is how to mix parameters arriving in the same cell. Here
we propose two different methods which are respectivelyav-
erageandsoftmax sampling.  The former makes a weighted
average of incoming parameters with respect to the quanti-
ties of incoming matter and is formally defined as :
## P
t+dt
## (p) =
## P
p
## ′
## ∈L
## A
t
## (p
## ′
)I(p
## ′
,p)P
t
## (p
## ′
## )
## P
p
## ′
## ∈L
## A
t
## (p
## ′
)I(p
## ′
## ,p)
## (9)
Softmax sampling on the other hand samples a parameter
in the set of incoming ones following the softmax distribu-
tion given by incoming quantities of matter :
## P[P
t+dt
(p) =P
t
## (x)] =
exp(A
t
(x)I(x,p))
## P
p
## ′
## ∈L
exp(A
t
## (p
## ′
)I(p
## ′
## ,p))
## (10)
Intuitively, the more represented set of parameters has a
greater probability of being selected in the cell, like simu-
lating in one step a competition between different parame-
ters in the cell.   Note that we could also sample each ele-
ment of the vector of parameters independently giving some
crossover mechanism. We can also add mutations in the sim-
ulation. For instance, we can, at a given rate, modify param-
eters in a randomly sampled zone by adding Gaussian noise
to the parameter map.
The parameters embedding mechanism allows to run multi-
species simulations where all creatures patches are initial-
ized with different parameters as shown in figure 6(a) where
colors code for parameters.   We ran simulations with ran-
dom set of parameters and initialization patterns.   We can
see that the creatures, although in the same CA, display dif-
ferent morphologies even though they have been initialised
with the same pattern.  We also ran larger scale simulations
(e.g1024×1024worlds initialized with 144 creatures and
simulated for 200k timesteps) using parameter embedding
as shown in figure 6(b-e). Such a simulation display very in-
teresting dynamics on the large scale where some “species”
can take over large parts of the world by contaminating other
species before reaching more stable states. Also, we can see
Downloaded from http://direct.mit.edu/isal/proceedings-pdf/isal2023/35/131/2354989/isal_a_00651.pdf by guest on 24 January 2026

the emergence of coherent creatures composed of different
parameters where one of those will compose a sort of mem-
brane around a nuclei composed by different parameters (see
green and pink creature on bottom left of figure 6(e)). Such
a pattern can be seen as a form of symbiosis.
While  parameter  embedding  could  lead  to  the  emergence
of intrinsic evolutionary processes where parameters would
compete for available matter, we can also add intrinsic se-
lective pressures in the form of resource collection mecha-
nisms bootstrapping evolution.  The idea is to add food re-
sources that creatures would need to collect in order to re-
plenish their own constantly decaying pool of resources. To
do so, we let matter decay at a fixed rateρ
decay
, and create
a food mapΨ :L →R
## ≥0
.  When matter is in a cell where
there is also food, then food is transformed into matter at a
given rateρ
digest
giving the following update.
## (
## A
t+dt
(x) =···+ [A
t
## (x)ρ
digest
## ]
## Ψ
t
## (x)
## 0
## −A
t
## (x)ρ
decay
## Ψ
t+dt
## (x) = Ψ
t
(x)−[A
t
## (x)ρ
digest
## ]
## Ψ
t
## (x)
## 0
## (11)
Where···refers to the update equation 6 and[·]
b
a
is the clip
function betweenaandb. We enable creatures to sense food
by adding kernels and growth function from the food mapΨ
to creatures’ channelsA.
By performing simulations with random set of parameters,
parameter embedding and food,  we have been able to ob-
serve interesting patterns.  First,  we have been able to ob-
serve  that  some  creatures,  while  not  having  trained  for  it,
are  able  to  go  towards  nearby  food  sources  and  consume
it.  We can hypothesize that creatures with such a capability
will survive (and grow) while other will not leading to in-
trinsic evolution.  Quite interestingly, complex patterns can
emerge from the change of mass induced by decay or food
consumption. For instance, when growing after eating, some
creatures will divide in two identical creatures as shown in
figure 6 (f),  crucial pattern for evolution to occur.  On the
other hand,  mass decay also leads to interesting dynamics
where  creatures  undergo  phase  transitions,  changing  their
shape and behavior,  when their mass falls below a certain
threshold which can lead them to adopt foraging behaviour
for example while being initially static.
## Discussion
Due to the mass conservative nature of Flow Lenia, most of
patterns do not grow indefinitely into spatially global pat-
terns (i.e patterns that diffuse on the entire grid also called
Turing-like patterns), therefore SLPs are much more com-
mon and easier to find. This is an important difference from
the previous versions of Lenia, where one needs to search
or evolve for patterns that are both non-vanishing and non-
exploding,  and  to  constantly  monitor  their  existential  sta-
tus.  Here, the mass conservation constraint acts as a regu-
larizer on the kind of patterns that can emerge. Even though
patterns generated by Flow Lenia are often static or slowly
moving, we have been able to find creatures with complex
dynamics from random search only which would be a diffi-
cult task in Lenia as most of the search space corresponds
to either exploding or vanishing patterns.  Furthermore, we
have shown that the update rule parameters can be optimized
with simple evolutionary strategies to generate patterns with
specific properties and behaviors. Doing so in Lenia is a dif-
ficult task since the spatial localization of emergent patterns
is not guaranteed necessitating more complex algorithms ac-
counting for such a property.
Finally we showed that the Flow Lenia system allowed for
the  integration  of  the  update  rule  parameters  within  the
CA dynamics allowing for the coexistence of multiple up-
date rules, and thus different creature or species, within the
same  simulation.   We  argue  that  such  a  feature  represent
an  important  step  towards  the  design  of  emergent  micro-
cosms (Arbesman, 2022) in which could emerge intrinsic,
maybe  open-ended,  evolutionary  processes  through  inter-
species interactions.   Moreover,  we also showed that food
consumption mechanisms can be implemented in Flow Le-
nia which could act as intrinsic selective pressures in such
settings bootstrapping evolutionary processes though com-
petitive dynamics.   Whereas environment design is poorly
addressed  and  quite  challenging  in  cellular  automata  sys-
tems, we believe that it is crucial to study the emergence of
agency and cognition in those systems as argued in Godfrey-
Smith  (2002)  and  shown  in  Hamon  et  al.  (2022).   By  en-
abling  the  design  of  complex  environmental  features  like
inter-species interactions, walls, food or temperature, Flow
Lenia  could  represent  a  particularly  interesting  system  to
study ecological theories of the evolution of complexity and
cognition (Nisioti et al., 2021).
Lot  of  exciting  roads  remain  to  be  taken  in  order  to  fully
capture the value of complex self-organized systems such as
Flow Lenia.  A major path to explore is about the detection
of agency and cognition in such systems where everything
is emergent with no predefined notion of individuals. Infor-
mation theoretical measures of concepts like individuality,
autonomy and agency (Krakauer et al., 2020; Bertschinger
et al., 2008; Negru, 2021; Kolchinsky and Wolpert, 2018)
could  be  of  great  interest  in  this  perspective  even  though
they remain difficultly applicable in large systems. Demon-
strating  the  emergence  of  intrinsic  evolutionary  processes
has  been  left  out  of  the  scope  of  this  paper  and  left  for
future  work.   However,  evaluating  such  a  system  appears
as a difficult task.   Quantifying intrinsic evolutionary pro-
cesses with measures like evolutionary activity (Bedau and
Packard, 1996; Droop and Hickinbotham, 2012) could re-
veal to be useful in order to get a better grasp on the complex
dynamics taking place in simulations such as the one shown
in figure 6. Ultimately, such simulations could be key for the
growth of complexity inside the system and the emergence
of virtual creatures displaying more complex forms of cog-
nition.
Downloaded from http://direct.mit.edu/isal/proceedings-pdf/isal2023/35/131/2354989/isal_a_00651.pdf by guest on 24 January 2026

## References
## Arbesman, S. (2022). Emergent Microcosms.
Bedau, M. A. and Packard, N. H. (1996).  Measurement of Evolu-
tionary Activity, Teleology, and Life.
Bertschinger,  N.,  Olbrich,  E.,  Ay,  N.,  and  Jost,  J.  (2008).   Au-
tonomy:  An information theoretic perspective.Bio Systems,
## 91(2):331–345.
## Bradbury,  J.,  Frostig,  R.,  Hawkins,  P.,  Johnson,  M.  J.,  Leary,
C.,  Maclaurin,  D.,  Necula,  G.,  Paszke,  A.,  VanderPlas,  J.,
Wanderman-Milne, S., and Zhang, Q. (2018). JAX: Compos-
able transformations of Python+NumPy programs.
Chan, B. W.-C. (2019). Lenia - Biology of Artificial Life.Complex
## Systems, 28(3):251–286.
Chan, B. W.-C. (2020). Lenia and Expanded Universe. InThe 2020
Conference on Artificial Life, pages 221–229.
Droop, A. and Hickinbotham, S. (2012). A quantitative measure of
non-neutral evolutionary activity for systems that exhibit in-
trinsic fitness.  InALIFE 2012: The Thirteenth International
Conference  on  the  Synthesis  and  Simulation  of  Living  Sys-
tems, pages 45–52. MIT Press.
Froese, T. and Ziemke, T. (2009).  Enactive artificial intelligence:
Investigating the systemic organization of life and mind.Ar-
tificial Intelligence, 173(3):466–500.
Godfrey-Smith, P. (2002).  Environmental complexity and the evo-
lution of cognition.  InThe Evolution of Intelligence, pages
## 223–249.  Lawrence  Erlbaum  Associates  Publishers,  Mah-
wah, NJ, US.
Hamon, G., Etcheverry, M., Chan, B. W.-C., Moulin-Frier, C., and
Oudeyer, P.-Y. (2022).  Learning sensorimotor agency in cel-
lular automata.
Hickinbotham, S. and Stepney, S. (2015).  Conservation of Matter
Increases Evolutionary Activity.   InECAL 2015:  The 13th
European Conference on Artificial Life, pages 98–105. MIT
## Press.
Kingma, D. P. and Ba, J. (2017).  Adam: A Method for Stochastic
## Optimization.
Kolchinsky, A. and Wolpert, D. H. (2018).  Semantic information,
autonomous agency and non-equilibrium statistical physics.
## Interface Focus, 8(6):20180041.
Krakauer, D., Bertschinger, N., Olbrich, E., Flack, J. C., and Ay,
N. (2020).  The information theory of individuality.Theory
in Biosciences, 139(2):209–223.
Lange, R. T. (2022). Evosax: JAX-based Evolution Strategies.
Lehman,  J.  and  Stanley,  K.  O.  (2011).   Novelty  Search  and  the
Problem  with  Objectives.   In  Riolo,  R.,  Vladislavleva,  E.,
and Moore, J. H., editors,Genetic Programming Theory and
Practice  IX,  Genetic  and  Evolutionary  Computation,  pages
37–56. Springer, New York, NY.
Mordvintsev, A., Niklasson, E., and Randazzo, E. (2022).   Parti-
cle Lenia and the energy-based formulation.  https://google-
research.github.io/self-organising-systems/particle-lenia/.
Moroz,M.(2020).Reintegrationtracking.
https://michaelmoroz.github.io/Reintegration-Tracking/.
Negru, T. (2021).  Self, Agency and Autonomy in Dynamical Liv-
ing Systems.Synthesis philosophica, 36(1):191.
Nisioti,  E.,  Jodogne-del  Litto,  K.,  and  Moulin-Frier,  C.  (2021).
Grounding an Ecological Theory of Artificial Intelligence in
Human Evolution.   InNeurIPS 2021 - Conference on Neu-
ral Information Processing Systems / Workshop:  Ecological
Theory of Reinforcement Learning, virtual event, France.
Oros,  N. and Nehaniv,  C. (2007).Sexyloop:  Self-Reproduction,
Evolution and Sex in Cellular Automata.
Rafler, S. (2011). Generalization of Conway’s ”Game of Life” to a
continuous domain - SmoothLife.
Salimans, T., Ho, J., Chen, X., Sidor, S., and Sutskever, I. (2017).
Evolution Strategies as a Scalable Alternative to Reinforce-
ment Learning.arXiv:1703.03864 [cs, stat].
Sayama, H. (1999).  Toward the realization of an evolving ecosys-
tem on cellular automata.Proc. Fourth Int. Symp. Artificial
Life and Robotics, pages 254–257.
Stanley, K. O. (2019).   Why Open-Endedness Matters.Artificial
## Life, 25(3):232–235.
Downloaded from http://direct.mit.edu/isal/proceedings-pdf/isal2023/35/131/2354989/isal_a_00651.pdf by guest on 24 January 2026